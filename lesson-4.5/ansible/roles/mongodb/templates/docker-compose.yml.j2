version: "3.3"

services:
  mongodb:
    image: mongo:{{ mongodb_version }}
    container_name: mongodb
    restart: always
    env_file: ./.env
    ports:
      - {{ mongodb_port }}:27017
    user: "{{ ansible_facts.getent_passwd.mongo_user[1] }}:{{ ansible_facts.getent_passwd.mongo_user[2] }}"
    volumes:
      - data:/data/db
      - config:/data/configdb:ro

volumes:
  config:
  data:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: {{ mongodb_data_path }}